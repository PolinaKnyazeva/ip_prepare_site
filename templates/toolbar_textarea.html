<div class="tools_tag_bar">
    <div class="bar_item_group_buttons" style="border-left: 0px">
        <a href="#" class="bar_item dropdown" id="first_bar_item" title="Заголовок">
            <svg class="svg_icon_for_toolsbar" viewBox="0 0 512 512">
                <path d="M416.435,0h-49.801c-18.201,0-32.963,14.753-32.963,32.963v153.883H155.748V32.963c0-18.21-14.76-32.963-32.963-32.963
                H72.982C54.781,0,40.02,14.753,40.02,32.963v423.494c0,18.209,14.761,32.963,32.962,32.963h49.803
                c18.203,0,32.963-14.754,32.963-32.963V302.574h177.924v153.883c0,18.209,14.762,32.963,32.963,32.963h49.801
                c18.203,0,32.965-14.754,32.965-32.963V32.963C449.4,14.753,434.638,0,416.435,0z"></path>
            </svg>

            <div class="dropdown-content headers_drop_content">
                <div class="dropdown_row">
                   <object class="dropdown_item_headers">
                    <a href="#" class="dropdown_item" onclick="insertTag('text', '<h1></h1>', 4)">
                        <svg width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z"/>
                            <line x1="3" y1="5" x2="3" y2="19" />
                            <line x1="3" y1="12" x2="12" y2="12" />
                            <line x1="12" y1="5" x2="12" y2="19" />
                            <path d="M20 19v-10l-3 3" />
                        </svg>
                    </a>
                    </object>
                    <object class="dropdown_item_headers">
                     <a href="#" class="dropdown_item" onclick="insertTag('text', '<h2></h2>', 4)">
                        <svg width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z"/>
                            <line x1="3" y1="5" x2="3" y2="19" />
                            <line x1="3" y1="12" x2="12" y2="12" />
                            <line x1="12" y1="5" x2="12" y2="19" />
                            <path d="M21 19h-5 l 4.47 -5.96 a2.5 2.5 0 1 0 -4.47 -1.54" />
                        </svg>
                     </a>
                    </object>
                     <object class="dropdown_item_headers">
                        <a href="#" class="dropdown_item" onclick="insertTag('text', '<h3></h3>', 4)">
                            <svg width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z"/>
                                <line x1="3" y1="5" x2="3" y2="19" />
                                <line x1="3" y1="12" x2="12" y2="12" />
                                <line x1="12" y1="5" x2="12" y2="19" />
                                <path d="M16 11.5a2.5 2.5 0 1 1 2.5 2.5a2.5 2.5 0 1 1 -2.5 2.5" />
                            </svg>
                        </a>
                     </object>
                </div>
                <div class="dropdown_row">
                        <object class="dropdown_item_headers">
                            <a href="#" class="dropdown_item" onclick="insertTag('text', '<h4></h4>', 4)">
                                <svg width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z"/>
                                    <line x1="3" y1="5" x2="3" y2="19" />
                                    <line x1="3" y1="12" x2="12" y2="12" />
                                    <line x1="12" y1="5" x2="12" y2="19" />
                                    <path d="M20 19v-10l-5 8h7" />
                                </svg>
                            </a>
                        </object>
                        <object class="dropdown_item_headers">
                            <a href="#" class="dropdown_item" onclick="insertTag('text', '<h5></h5>', 4)">
                                <svg width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z"/>
                                    <line x1="3" y1="5" x2="3" y2="19" />
                                    <line x1="3" y1="12" x2="12" y2="12" />
                                    <line x1="12" y1="5" x2="12" y2="19" />
                                    <path d="M16 18.27 a3 3 0 1 0 0 -4.537 l0 -4.733 h 5" />
                                </svg>
                            </a>
                        </object>
                        <object class="dropdown_item_headers">
                            <a href="#" class="dropdown_item" onclick="insertTag('text', '<h6></h6>', 4)">
                                <svg width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z"/>
                                    <line x1="3" y1="5" x2="3" y2="19" />
                                    <line x1="3" y1="12" x2="12" y2="12" />
                                    <line x1="12" y1="5" x2="12" y2="19" />
                                    <circle cx="18.5" cy="16.5" r="2.5" />
                                    <line x1="20" y1="9" x2="16.5" y2="15" />
                                </svg>
                            </a>
                        </object>
                </div>
            </div>
        </a>

        <a href="#" class="bar_item" id="middle_bar_item" title="Жирный шрифт" onclick="insertTag('text', '<b></b>', 3)">
            <svg class="svg_icon_for_toolsbar" viewBox="0 0 32 32">
                <path class="path1" d="M8.356 0.572c1.554-0.328 4.010-0.572 6.504-0.572 3.56 0 5.852 0.612 7.568 2.006 1.432 1.062 2.292 2.7 2.292 4.868 0
                2.658-1.758 4.99-4.664 6.054v0.082c2.618 0.654 5.686 2.824 5.686 6.914 0 2.372-0.942 4.17-2.332 5.524-1.924 1.758-5.032 2.578-9.532 2.578-2.456
                0-4.338-0.164-5.524-0.33v-27.124zM11.916 11.864h3.232c3.764 0 5.972-1.964 5.972-4.622 0-3.232-2.456-4.5-6.054-4.5-1.638 0-2.576 0.122-3.15 0.244v8.878zM11.916
                25.078c0.694 0.122 1.718 0.162 2.986 0.162 3.68 0 7.078-1.35 7.078-5.36 0-3.76-3.232-5.316-7.118-5.316h-2.946v10.514z" opacity="1" visibility="false"></path>
            </svg>
        </a>

        <a href="#" class="bar_item" id="last_bar_item" title="Курсив" onclick="insertTag('text', '<i></i>', 3)">
            <svg class="svg_icon_for_toolsbar" viewBox="0 0 32 32">
                <path class="path1" d="M15.152 0h3.204l-5.928 28.030h-3.202l5.926-28.030z" opacity="1" visibility="false"></path>
                <path class="path2" d="M6 24h12v4h-12v-4z" opacity="1" visibility="false"></path>
                <path class="path3" d="M10 0h12v4h-12v-4z" opacity="1" visibility="false"></path>
            </svg>
        </a>
    </div>

    <div class="bar_item_group_buttons">
        <a href="#" class="bar_item" id="first_bar_item" title="Нумерованный список" onclick="insertTag('text','<ol>\n\t<li></li>\n</ol>')">
            <svg class="svg_icon_for_toolsbar" viewBox="0 0 1024 1024">
                <g><g><g><path d="M969.3,80.7h-681c-11.5,0-20.7,9.3-20.7,20.7v111.6c0,11.5,9.3,20.7,20.7,20.7h681c11.5,0,20.7-9.3,20.7-20.7V101.5C990,90,980.7,80.7,969.3,80.7z"/><path d="M969.3,429.6h-681c-11.5,0-20.7,9.3-20.7,20.7V562c0,11.5,9.3,20.7,20.7,20.7h681c11.5,0,20.7-9.3,20.7-20.7V450.4C990,438.9,980.7,429.6,969.3,429.6z"/><path d="M969.3,789.1h-681c-11.5,0-20.7,9.3-20.7,20.7v111.6c0,11.5,9.3,20.7,20.7,20.7h681c11.5,0,20.7-9.3,20.7-20.7V809.8C990,798.4,980.7,789.1,969.3,789.1z"/><path d="M29.1,125.2c4.4,0.5,8.8-0.8,12.1-3.7l9.5-8.3v134.6c0,8.6,7,15.6,15.6,15.6h16c8.6,0,15.6-7,15.6-15.6v-180c0-8.6-7-15.6-15.6-15.6H65.8c-3.7,0-7.3,1.3-10.1,3.7L15.5,90.2c-6.1,5.2-7.3,14.2-2.7,20.8l5.4,7.7C20.8,122.3,24.7,124.6,29.1,125.2z"/><path d="M36.4,399c-6.7,2.4-10.9,9-10.3,16.1l1,10.4c0.5,5.2,3.5,9.7,8.1,12.2c4.5,2.5,10,2.5,14.6,0.1c12.2-6.4,20-8,30.3-5.5c7.4,1.7,12.3,6.1,14.9,12.7c3.9,11.9,4.1,30.7-29.6,71.3l-26,31.1c-6.1,7.2-10.3,11.6-13.5,14.6s-5.1,7.1-5.1,11.5v15.3c0,8.6,7,15.6,15.6,15.6h94.7c8.6,0,15.6-7,15.6-15.6v-8.1c0-8.6-7-15.6-15.6-15.6H81.5c4.8-5.3,10.8-12.6,17.8-21.4c29.1-36,52.5-68.9,44.5-107.6c-3.2-17.3-12.9-30.8-28.3-38.9c-8.6-4.4-19.5-6.6-32.4-6.6C68.4,390.5,51.8,393.5,36.4,399z"/><path d="M118.8,834.8c2.6-1.4,5-3,7.7-5c17.8-13.6,18.7-34.6,18.5-40.3c0-19.5-7.4-34.4-22.5-45.7c-10.6-8-26.3-12.2-45.2-12.2c-14,0-28.9,2.2-42.1,6.2c-6.9,2.1-11.5,8.7-11,15.9l0.6,9.1c0.3,4.9,2.9,9.3,7,12c4.1,2.7,9.2,3.3,13.8,1.7c9-3.2,16.3-4.7,23.1-4.7c2.4,0,4.7,0.2,7.5,0.7c9.7,1.3,16.2,5.7,19.7,13.3c2.5,5.4,2,15-0.9,19.5c-6.8,10.5-25.3,12.6-35.7,13c-8.4,0.2-15.1,7.1-15.1,15.5v6.8c0,8.6,7.1,15.6,15.7,15.6c16.3,0,24,3.2,26.9,5c7.6,4.8,11.1,10.8,11.1,19.9c0.3,9.5-3.6,16.7-11.7,22c-10.5,6.7-27.4,6.7-46.7,0.3c-4.5-1.5-9.5-0.9-13.5,1.8c-4,2.6-6.5,7-6.9,11.7l-0.7,9c-0.5,6.8,3.5,13.2,9.8,15.7c3.4,1.3,5.7,1.9,10.6,2.9c8.9,2,19.1,3.1,29.5,3.1c15.5,0,44.1-2.6,61.7-19.9c17.2-17.5,20.5-42.6,16.2-59.4C141.1,847.1,128.9,839.2,118.8,834.8z"/></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></g>
            </svg>
        </a>

        <a href="#" class="bar_item" id="last_bar_item" title="Ненумерованный список" onclick="insertTag('text','<ul>\n\t<li></li>\n</ul>')">
            <svg class="svg_icon_for_toolsbar" viewBox="0 0 1024 1024">
                <path class="path1" d="M320 128h576v128h-576v-128z"></path>
                <path class="path2" d="M128 128h128v128h-128v-128z"></path>
                <path class="path3" d="M320 448h576v128h-576v-128z"></path>
                <path class="path4" d="M128 448h128v128h-128v-128z"></path>
                <path class="path5" d="M320 768h384v128h-384v-128z"></path>
                <path class="path6" d="M128 768h128v128h-128v-128z"></path>
            </svg>
        </a>

    </div>

    <div class="bar_item_group_buttons">
        <a href="#" class="bar_item" id="first_bar_item" title="Вставить ссылку" onclick='insert_link()'>
            <svg class="svg_icon_for_toolsbar" viewBox="0 0 1024 1024">
                <g><g transform="translate(0.000000,511.000000) scale(0.100000,-0.100000)">
                    <path d="M7422,4990.7c-317.9-46.9-657-179.2-938.6-366.9c-179.2-119.5-1433.5-1367.4-1484.7-1476.2c-74.7-160-40.5-311.5,96-433c42.7-36.3,104.5-72.5,136.5-81.1c81.1-17.1,356.3-87.5,492.8-125.9c91.7-25.6,134.4-25.6,213.3-6.4c89.6,21.3,153.6,78.9,674.1,593c499.2,490.6,593,576,704,622.9c846.9,373.3,1687.4-490.6,1279.9-1316.2c-68.3-138.7-168.5-245.3-1454.8-1527.4C5525.6-734.8,5662.1-628.1,5224.8-628.1c-241,0-264.5,4.3-394.6,66.1c-76.8,36.3-194.1,110.9-262.4,166.4c-68.3,55.4-147.2,108.8-177.1,119.5c-76.8,29.9-189.9,25.6-270.9-8.5c-85.3-38.4-494.9-452.2-524.8-531.2c-61.9-164.3-14.9-300.8,162.1-462.9c629.3-582.4,1587.1-733.8,2367.9-373.3c343.4,160,401,209.1,1836.7,1640.4C8742.5,767,9391,1428.3,9463.5,1526.4c539.7,708.2,582.4,1698,108.8,2461.7c-200.5,320-603.7,678.4-927.9,821.3C8249.7,4984.3,7818.8,5048.3,7422,4990.7z"/><path d="M4493.1,2049c-347.7-49.1-761.6-219.7-1028.2-424.5C3249.5,1460.3,585.1-1223.3,480.6-1381.2c-501.3-748.8-507.7-1704.4-17.1-2442.5c145.1-217.6,441.6-505.6,657-640c763.7-473.6,1753.5-430.9,2461.7,108.8c93.9,70.4,480,439.5,859.7,819.2c569.6,573.8,686.9,701.8,691.2,755.2c10.7,232.5-66.1,315.7-341.3,362.6c-89.6,17.1-266.7,57.6-392.5,93.9c-217.6,61.9-251.7,64-390.4,27.7c-23.5-6.4-300.8-268.8-618.6-580.2c-501.3-497.1-593-578.1-706.1-627.2c-326.4-142.9-706.1-104.5-985.5,100.3c-384,283.7-505.6,787.1-292.3,1218c68.3,138.7,166.4,243.2,1454.9,1527.4C4476.1,950.4,4339.5,843.8,4776.8,843.8c241,0,264.5-4.3,394.6-66.1c76.8-36.3,194.1-110.9,262.4-166.4c68.3-55.5,147.2-108.8,177.1-119.5c70.4-27.7,183.5-27.7,258.1,2.1c78.9,29.9,492.8,439.4,531.2,524.8c36.3,81.1,38.4,194.1,6.4,277.3c-70.4,187.7-535.4,518.4-915.2,650.6C5209.9,2044.8,4776.8,2089.6,4493.1,2049z"/></g></g>
            </svg>
        </a>

        <a href="#" class="bar_item" id="last_bar_item" title="Вставить изображение" onclick='insert_image_from_ethernet()'>
            <svg class="svg_icon_for_toolsbar" viewBox="0 0 32 32">
                <path class="path1" d="M13.958 9.852c0 1.744-1.414 3.158-3.158 3.158s-3.158-1.414-3.158-3.158c0-1.744 1.414-3.158 3.158-3.158s3.158 1.414 3.158 3.158z" opacity="1" visibility="false"></path>
                <path class="path2" d="M27.078 24l-6.268-13.118-4.952 10.138-3.79-3.9-6.988 6.88z" opacity="1" visibility="false"></path>
                <path class="path3" d="M28 4v24h-24v-24h24zM32 0h-32v32h32v-32z" opacity="1" visibility="false"></path>
            </svg>
        </a>
    </div>

</div>

<textarea class="form-control textarea_ticket dark_theme_input" name="text" id="text">{% if ticket %} {{ ticket.text }} {% endif %}</textarea>


{#<div class="modal_bg"  style="display: block; position: fixed; top: 0; left: 0; opacity: 0; visibility: hidden; width: 100%;height: 100%">#}
{#    <div class="modal_window" style="position: relative; vertical-align: middle;background: antiquewhite;">#}
{#        <div class="modal_close" >#}
{#            X#}
{#        </div>#}
{#        <div class="modal_content">#}
{##}
{#        </div>#}
{#        <div class="modal_button_submit">#}
{##}
{#        </div>#}
{#    </div>#}
{#</div>#}

<script>
    function insertTag( id_inserting, text, cursor_position=undefined ) {
    var textarea = document.getElementById(id_inserting);//ищем элемент по id
    var start = textarea.selectionStart; //ищем первое положение выделенного символа
    var end = textarea.selectionEnd; //ищем последнее положение выделенного символа
    var finText = textarea.value.substring(0, start) + text + textarea.value.substring(end); // текст до + вставка + текст после
    textarea.value = finText; // подмена значения

    textarea.focus(); // возвращаем фокус на элемент
    if (cursor_position==undefined){
        cursor_position=text.length;
    }
    textarea.selectionEnd = (start == end) ? (end + cursor_position) : end ; // возвращаем курсор на место - учитываем выделили ли текст или просто курсор поставили

}
    function insert_image_from_ethernet() {
        var link_image = prompt("Введите адрес изображения", "http://");
        if (link_image != null)
            insertTag("text", "<img src=" + "\"" + link_image + "\" " + "alt=\"image\">");
    }

    function insert_link() {
        var link = prompt("Ссылка (URL)", "http://");
        if (link != null)
            insertTag('text', "<a href=" + "\"" + link + "\"" + "></a>")
    }
</script>